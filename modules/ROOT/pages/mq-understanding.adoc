= Anypoint MQ Terminology
ifndef::env-site,env-github[]
include::_attributes.adoc[]
endif::[]
:imagesdir: ../assets/images/


The Anypoint MQ messaging broker enables applications to communicate by publishing a Mule message to a queue so that another app can consume the message.

Anypoint MQ supports hybrid use cases, IoT in which you collect data from different devices, and a REST API you can use with device applications. You can also use Anypoint MQ with other app frameworks such as node.js to communicate to queues.

Anypoint MQ:

* Provides fully hosted and managed queues and message exchanges in the cloud. A queue is a temporary storage area. A message exchange binds one or more queues so that a message sent to a message exchange appears in all its bound queues simultaneously.

* Supports using the Connected Apps feature to authenticate with Anypoint Platform using APIs.
+
See xref:mq-connected-apps.adoc[].
* Supports large payloads, encryption, queuing, and publish/subscribe (pub/sub) paradigms.
* Enables you to easily connect to non-Mule applications using the REST API.
* Provides Anypoint Studio access, which makes the process of leveraging your queues and message exchanges as simple as drag, drop, and configure.
* Displays usage statistics on the number of messages and API requests so you can manage peak usage and subscription parameters.
* Provides dead-letter queue capability for undeliverable messages.
* Enables you to delay message delivery at the queue and message level.
* Provides the ability to group messages in FIFO queues.

== Queues

Message queues provide temporary storage that enables applications to communicate in a scalable and reliable way. Publishers can publish messages into queues, and subscribers can receive messages from queues. You can create a dead-letter queue to store undeliverable messages.

image::mq-pub-q-sub.png[Anypoint MQ Publisher-Queue-Subscriber]

Queues provide these benefits:

* *Horizontal scalability*
+
By putting a message on a queue, the work to process that message can be distributed over multiple subscribers.
* *Reliability*
+
Queues ensure that messages are always processed, even in the case of failure.
+
Anypoint MQ provides reliability with queues using a lock and acknowledge mechanism.
These features ensure that a message is always processed, even in the case of failure.
+
* *Decoupling*
+
A queue can be used as a communication mechanism between different applications and devices, allowing them to have different development life cycles or maintenance windows, without affecting other applications.
* *Aggregation*
+
Multiple message producers can publish to a single queue, which enables easy consumption by consumers.
+
.. A consumer retrieves messages from a queue. This locks the messages and makes the messages invisible to all other consumers.
.. When retrieving, the consumer specifies a lock timeout. If the message is not processed within that time window, the message is made visible to other consumers to be processed. This ensures that if there was a failure of some sort, such as the consumer node crashed, a message can be processed by another node. A locked message does not block other messages to be read. The lock makes a message unavailable to other applications while locked.
+
If a consumer processes a message successfully, the client acknowledges the message, and Anypoint MQ removes the message from the queue.
For more information about how Anypoint MQ processes acknowledged messages, see xref:anypoint-mq-connector::anypoint-mq-ack.adoc[ACK and NACK Operations].
+
If a consumer is not able to process a message, the message proceeds with a negative acknowledgment and becomes visible in the queue again.

* *Message TTL*
+
Each queue has a message time-to-live (TTL). TTL specifies how long the message is in the queue before Anypoint MQ expires the message and removes it from the queue.
+
include::partial$mq-ttl.adoc[tag=msgTTLchange]

[message-lock-ttl]
* *Default Acknowledgement Timeout* 
+
How long a message remains unacknowledged before being returned to the queue: for example, in the event of server failure or when flow processing takes too long and times out.

* *Unlimited messages in a queue*
+
There is no limit on the number of messages in a queue. Each message in a queue is limited to 10 MB. 
* *Long polling*
+
Messages are read through long polling. The server holds a request open until new data is available, and then Anypoint MQ delivers a batch of messages with a single read.

* *Billing and charging*
+
Billing is based on the number of messages delivered to subscribers from queues, not the number of queues or message exchanges you create.

== Connected Apps

In Anypoint MQ, each consumer must be registered as a connected app with a name, ID, and a secret.
The connected app uses the ID and secret to authenticate and get access to queues and message exchanges within a single environment.
You cannot use connected apps across multiple environments or business groups.

== Message Exchanges

With message exchanges you can distribute a single message to multiple consumers.

image::mq-pub-ex-sub.png["Message exchanges distributing a message to multiple consumers"]

For example, if a publisher publishes changes in the weather, and you have multiple apps that want to receive that data, you can use a message exchange to publish a single message to multiple queues for each app.

A _binding_ is a relationship between the queue and message exchange, which tells the message exchange where to send messages. A queue can be bound to multiple message exchanges.
// Max Msg Exchange 
include::partial$mq-msg-exchange.adoc[tag=msgExchangeMax]
include::partial$mq-msg-exchange.adoc[tag=msgExchangeMaxRouting]

== Example

In this example, an app running Salesforce customer relationship manager (CRM) wants to communicate with two applications that handle different databases.

image::mq-crm-to-dbs.png["CRM sends msg to Anypoint MQ that apps receive"]

Using Anypoint MQ, the Salesforce app sends a pub/sub message to a message exchange, and the two applications receive the message from the message exchange and convey the message to their respective databases.


== See Also

* xref:mq-faq.adoc[Anypoint MQ FAQ]
* xref:mq-queues.adoc#dead-letter-queues[Dead Letter Queues]
